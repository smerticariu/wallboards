<apex:page docType="html-5.0">
  <html>
    <head>
      <title>Wallboards</title>
      <script type="text/javascript">
        window.WbConfig = {
            sfSessionId: "{!$Api.Session_ID}",
        };
      </script>
      <script src="/soap/ajax/35.0/connection.js" type="text/javascript"></script>
      <script src="/soap/ajax/35.0/apex.js" type="text/javascript"></script>
      <script type="text/javascript">
        sforce.connection.sessionId = '{!$Api.Session_ID}';
      </script>
      <script>
          const usersPhotos = sforce.connection.query('Select id, name, SmallPhotoUrl, FullPhotoUrl From User');
          const usersIds = sforce.connection.query('Select name, nbavs__User__c,nbavs__Id__c, id From nbavs__User__c');
          let usersAvatars = [];
          usersPhotos.records.forEach(userPhoto => {
            usersIds.records.forEach(userId => {
              if(userPhoto.Id === userId.nbavs__User__c) {
                usersAvatars.push({
                  id: parseInt(userId.nbavs__Id__c),
                  smallPhoto: userPhoto.SmallPhotoUrl,
                  largePhoto: userPhoto.FullPhotoUrl,
                  name: userPhoto.Name
                })
              }
            })
          })
          
          window.WbConfig.usersAvatars = usersAvatars;
      </script>
    </head>
      <body>
      <div id="root"></div>
      <script src="https://wallboards.herokuapp.com/static/js/bundle.min.js"></script>
    </body>
  </html>
</apex:page>