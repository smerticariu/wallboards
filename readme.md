
# Wallboards
## 1. Technical details
###### 1.1 Installation
###### 1.2 Running Wallboards on local machine
###### 1.3 Sign In
## 2. How to use
## 3. How to create/edit configuration file

## 1. Technical details
Wallboards App was created with **ReactJs** library without any style frameworks.
The code is written using vanilla **Javascript(ES6)** and **SASS** preprocessor for styling.
All unit tests can be runned using **Jest**.
The production build is created using **Webpack**, it contains a single Javascript file(*bundle.min.js*). The build must contain a single Javascript file because it will be integrated in an iframe in **Salesforce Visualforce**.
All static resources were implemented as **Base64** data so the application does not need to access external resources when it’s integrated in an iframe.

### 1.1 Installation
Wallboards requires **Node.js v14.x** to run.

Install the dependencies and devDependencies and start the server.
```
cd frontend
npm install
npm run start:local
```
The production enrivonments will be served by an api.

### 1.2 Running Wallboards on local machine
The script *start:local* contains the environment variable value hardcoded for using the proper apis for development.
**Note**: For avoiding have CORS issues, a browser extension must be installed: https://chrome.google.com/webstore/detail/cross-domain-cors/mjhpgnbimicffchbodmgfnemoghjakai

### 1.3 Sign In
Wallboards provides access only by using Salesforce credentials.
There are two ways to have access to Wallboards data:
- By accessing the original host(e.g. https://flightdeck.natterbox.com)
- By accessing the Salesforce account

 For Signing in from the original host, the application will process the login using **https://auth0.com** services, which generates the **JWT token** based on access token.
 By accessing the Wallboards from the Salesforce account, the application will not ask for credentials, because it will have a valid JWT generated by **Gatekeeper**, based on the **Salesforce Session ID**.

## 2.How to use Wallboards
Depending on user permissions, the application has different behaviours:
- Administrator: has access to any resource of the wallboards
- Team Leader: has access to only to the it’s own resources and shared wallboards by other users(only view mode access).
- Basic User: has access only to wallboards shared by other users in read only mode

Each page of the application contains a toolbar. The content and buttons of the toolbar depends on the page.
The homepage of the Wallboards contains a list with wallboards:
- Administrator: can see all wallboards created by all users
- Team Leader: can see the wallboards created only by it
- Basic user: does not have access to homepage

Each Wallboard has three actions:
- Edit: opens the selected wallboard in edit mode where the user can modify it
- Copy: duplicates the selected wallboard, the new wallboard having the original wallboard name and have added Copy at the end of the name: e.g. My New Wallboard Copy
- Delete: deletes the selected wallboard

Each wallboard/wallboard group can be accessed manually by introducing the ID(coded in Base64) of the wallboard.
E.g.:
- Edit mode wallboard:https://flightdeck.natterbox.com/#/wallboard/id-coded-in-base64/edit
- Read-only wallboard: https://flightdeck.natterbox.com/#/wallboard/id-coded-in-base64

Identical to wallboards:
- Edit mode wallboards group:https://flightdeck.natterbox.com/#/group/id-coded-in-base64/edit
- Read-only wallboards group: https://flightdeck.natterbox.com/#/group/id-coded-in-base64

If the user does not have access to the wallboard, a notification will be displayed with **Access Denied**





## 3.How to create/edit configuration file
In order to display wallboards and wallboards groups in the table from landing page, there is needed a configuration file to store minimal data for each wallboard/wallboards group to avoid getting all data for all wallboard/wallboard group - this will take too many unnecessary server requests.

The method ```syncWallboardsWithConfig``` will create the configuration file(*config.json*), or if it does exist, the method will update the *config.json*.
The configuration file will not need an update because at each update to server(*post* or *put* requests) the *config.json* file will be updated.

The ```syncWallboardsWithConfig``` method will be called at the start of the ```fetchAllWallboardsThunk``` function from the ```wallboards.thunk.js``` file which can be found  at ```wallboards/frontend/src/store/thunk/wallboards.thunk.js```.
Being a *redux* method, ```syncWallboardsWithConfig``` will be *dispatched*.
Usage:
```dispatch(syncWallboardsWithConfig());```
The manual select the environment (dev, qa, stage, prod) it can be done from *authConfig.js* file and edited the *envHost* property with the desired host.
**Notes:**
- The configuration file must be *not* be deleted, otherwise the table from landing page will not work properly anymore.
- This operation should be done once per *Organization*, after that, the method call should be removed.
- This operation should be done only from a local machine(localhost).
- The method call should never be deployed to production and it should never end up to the end-user part.
## Extra
The code that will be added to the Visualforce page can be find in the **salesforce.html** file.
The host url of the **bundle.min.js** script depends on where the **Wallboards** app was deployed.